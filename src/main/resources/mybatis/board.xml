<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
	
	<sql id="search">
		SELECT * FROM board 
		<where>
			<if test="search == 1">
				BOARD_ID = #{keyword}
			</if>
			<if test="search == 2">
				BOARD_SJ LIKE CONCAT(CONCAT('%', #{keyword}), '%')
			</if>
		</where>
		ORDER BY BOARD_ID
	</sql>
	
	<select id="total" resultType="Integer">
		SELECT COUNT(*) FROM (<include refid="search"></include>)
	</select>
	
	<select id="boardlist" resultType="BoardVo">
		SELECT *  
		FROM BOARD
		ORDER BY BOARD_ID DESC
	</select>
	
	<select id="item" resultType="BoardVo">
		SELECT BOARD_ID,
			   USER_ID,
	   		   BOARD_SJ,
	   		   BOARD_CN,
	   		   BOARD_CO,
	   		   BOARD_IMG,
	   		   BOARD_FRST,
	   		   BOARD_LAST
	   		   
		FROM BOARD 
		WHERE BOARD_ID = #{boardId}
	</select>
	
	<insert id="boardadd">
		INSERT INTO board (
			BOARD_ID,
			USER_ID,
			BOARD_SJ,
			BOARD_CN,
			BOARD_CO,
			BOARD_IMG,
			BOARD_FRST
		)
		VALUES (
			BOARD_SQ.nextval,
			#{userId},
			#{boardSj},
			#{boardCn},
			0,
			#{boardImg},
			SYSDATE
		)
	</insert>
	
	<update id="boardupdate">
		UPDATE board
		SET BOARD_SJ = #{boardSj}, BOARD_CN = #{boardCn}, BOARD_IMG = #{boardImg}, BOARD_LAST = SYSDATE
		WHERE USER_ID = #{UsersVo.id} AND BOARD_ID = #{boardId}
	</update>
	
	<delete id="boarddelete">
		DELETE FROM board
		WHERE BOARD_ID = #{boardId}
	</delete>
</mapper>